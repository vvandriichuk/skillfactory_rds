{"paragraphs":[{"text":"%md\n# Ноутбук Виктора Андрийчука\n## для [раздела](https://lms.skillfactory.ru/courses/course-v1:Skillfactory+DST-10+22JAN2020/courseware/19a7384fba25470fa7ea7d38b77939ce/7943693de9264b3a926c1d91285a7ac5/17?activate_block_id=block-v1%3ASkillfactory%2BDST-10%2B22JAN2020%2Btype%40vertical%2Bblock%40c2373dc605e24e92af5fd7843df56834) 3.9. Сквозной проект. Шаг 3\n---\n### Задание: Вам нужно перенести данные из файлов и базы данных в Hive staging (создайте в Hive базу данных с именем \"вашлогинstaging\")","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:06:40+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"editorMode":"ace/mode/markdown","editorHide":true,"tableHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h1>Ноутбук Виктора Андрийчука</h1>\n<h2>для <a href=\"https://lms.skillfactory.ru/courses/course-v1:Skillfactory+DST-10+22JAN2020/courseware/19a7384fba25470fa7ea7d38b77939ce/7943693de9264b3a926c1d91285a7ac5/17?activate_block_id=block-v1%3ASkillfactory%2BDST-10%2B22JAN2020%2Btype%40vertical%2Bblock%40c2373dc605e24e92af5fd7843df56834\">раздела</a> 3.9. Сквозной проект. Шаг 3</h2>\n<hr/>\n<h3>Задание: Вам нужно перенести данные из файлов и базы данных в Hive staging (создайте в Hive базу данных с именем &ldquo;вашлогинstaging&rdquo;)</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346447_1542779679","id":"20210401-084833_435403549","dateCreated":"2021-04-05T12:05:46+0000","dateStarted":"2021-04-05T12:06:40+0000","dateFinished":"2021-04-05T12:06:40+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:17206"},{"text":"%md\n### 1. Перенос существующей в Hive таблицы cities в свою базу данных","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:06:47+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>1. Перенос существующей в Hive таблицы cities в свою базу данных</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346450_368233731","id":"20210402-031813_1513845475","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17207","dateFinished":"2021-04-05T12:06:47+0000","dateStarted":"2021-04-05T12:06:47+0000"},{"title":"1.1 Создаем свою базу данных","text":"%hive\ndrop database if exists vandriichuk_staging CASCADE;\ncreate database if not exists vandriichuk_staging;\nshow databases","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:06:50+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"2":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"database_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TABLE","data":"database_name\naastafurov\naastafurov_staging\naastafurov_test\nabondarev_datamart\nabondarev_datamart_opt\nabondarev_staging\nabondarev_staging_opt\nabondarev_test_db\nagolubev_dwh\nagolubev_staging\nagre_staging\nailexstading_1\nailexstaging\nakhmetov_staging\naleks_sngn_project\naleks_sngn_result\naleks_sngn_staging\nalekseyzelepukin\nalekseyzelepukin_staging\nalekseyzelepukin_test\nalex_zh_slack_staging\nandreynovikov_snowflake\nandreynovikov_staging\nannabys_staging\nannadb_test\nantark94_final\nantark94staging\napavlenko_staging\nariella_general\nariella_nobels\nariellas_staging\nblokhinns_staging\nchaynichkova_pr\nchaynichkova_sf\nchaynichkova_staging\nchaynichkova_staging5\ncppmyjob_staging\ncppmyjob_staging_5\ncppmyjob_warehouse\ncppmyjob_warehouse_5\ndbelyakov\ndbelyakov_staging\ndbelyakov_test\ndbelyakov_tests_x\ndefault\ndt_01\ndudukina_staging\ndzhuikov22_staging\ndzubov\ndzubov_staging\ndzubovstaging\neta_staging\neta_target\neta_test\nfathersdb\nfirsova\nfirsova_sv\ng0661504490staging\ngr_snowflake\ngr_staging\ngribunin_staging\ngribunin_star_and_ds\nia_db\nia_staging\nia_staging_6\nia_test\nialexeeva_staging\nianvroman_staging\nigor_01\nigor_k_410\nigor_k_staging\nigordb\nigork_dwh\nigork_staging515\nillya_step\nivan_kudashkin_staging\njugo_6_staging\njugo_dwh_5\njugo_gr\njugo_staging\njugo_staging_5\njugo_viens\nkaluginaev_test\nkaluginaev_test2\nkdstagin\nkdstaging\nkdstaging_target\nkdstaging_test\nkhaa_staging\nkhlopotin_snowflake\nkhlopotin_snowflake_regular\nkhlopotin_staging_regular\nkhodykin_staging\nkhudaleeva\nkhudaleeva_dwh\nkhudaleeva_st\nkhudaleeva_staging\nklantratovstaging\nknyazev\nknyazev_staging\nkorabelschikov_staging\nkorpachev_staging\nkristina_dudukina_staging\nkuzps_test_db\nlifirenko\nlifirenko_formats\nlifirenko_raw\nlifirenko_snowflake\nlifirenko_staging\nlifirenko_test\nloboda_staging\nlyudmila_cheshikhina_staging\nmaleksiunina_staging\nmaleksiunina_temp\nmalkhanova_staging\nmarkova_staging\nmarsel_robertovich_db\nmarsel_robertovich_db5\nmarsel_robertovich_staging\nmarsel_robertovich_staging5\nmbs_test\nmikhnov_staging\nmila_ches_staging\nmk_test\nmona_staging\nmrezakov_dwh_step5\nmrezakov_staging\nmrezakov_staging_step5\nmrezakov_star_and_ds\nmzhurbin_staging\nnbl_kh\nnovikov_andrey_phones\noagapov_staging\nolsapozhnikov_dwh_5\nolsapozhnikov_snowflake\nolsapozhnikov_staging\nolsapozhnikov_staging_5\np_staging\npae_db\npae_staging\npae_staging2\npbulavin_ds\npbulavin_dwh_5\npbulavin_staging\npbulavin_staging_5\npcdreams\npcdreams_staging\npetukhov_staging\npigidser\npigidser_datamart\npigidser_staging\npind\npind_staging\npismennii_rg_test_db\npkond_db_test\npkond_sqoop_test\npshenichnikov_staging\npshenichtmp\nrand1989_nobels_new\nrand_db_test\nrand_nobels\nrand_snowflake_6\nrand_staging\nrand_staging_6\nrand_staging_new\nred_staging\nred_staging_snowflake\nred_stagingg\nsavinov_staging\nschebola_mart\nserebrovdm_db\nserebrovdm_staging\nserguei_k\nserguei_k_staging\nserguei_k_test\nsf_de_mzhurbin\nshchepilov_staging\nsisemenishchev_staging\nsokaa\nsokaa_staging\nsokolov_im_5\nsokolov_im_6_staging\nsokolov_im_db\nsokolov_im_nobel\nsokolov_im_staging\nsokolov_im_staging_5\nsoldatova_staging\nsr_test\nstaging\nstaging_khaa\nstaging_kuzmenko\nstaging_sashpo74\nstas_db\nstas_snowflake_6\nstas_staging_6\nstas_test\nstas_test_db\nstaschebola_datamart_opt\nstaschebola_staging\nstaschebola_staging_opt\nstastest\nsudmal_db\nsudmal_db_5\nsudmal_file_formats\nsudmalstaging\nsudmalstaging5\nsusiak_db\ntashikk_staging\ntest\nthebigm\ntomarovskiy_staging\ntuidmebayev_da\ntuimebayev_da\ntuimebayev_staging\ntva_proj\nurzhumtsev_staging\nv_druzhinin\nvandriichuk\nvandriichuk_staging\nvashkovich_ds\nvashkovich_dwh_step5\nvashkovich_staging\nvashkovich_staging5\nvikafeliksovna_staging\nvjatchanin_staging\nvorontsov_staging\nxmtlzoo_staginh\nyessen\nyoineko_warehouse\nyoinekostaging\nzh_lib\n"}]},"apps":[],"jobName":"paragraph_1617624346452_1904762173","id":"20210401-084914_495230857","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17208","dateFinished":"2021-04-05T12:06:50+0000","dateStarted":"2021-04-05T12:06:50+0000"},{"title":"1.2 Импортируем таблицу cities в свою базу данных","text":"export tabName=\"cities\"\nexport dbName=\"vandriichuk_staging\"\n\n./vandriichuk/sqoopImport.sh $tabName $dbName","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:08:33+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true,"editorHide":false},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Importing cities table into database vandriichuk_staging with sqoop import...\nWarning: /usr/lib/sqoop/bin/../../accumulo does not exist! Accumulo imports will fail.\nPlease set $ACCUMULO_HOME to the root of your Accumulo installation.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/lib/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.slf4j.impl.Log4jLoggerFactory]\n2021-04-05 12:08:38,338 INFO sqoop.Sqoop: Running Sqoop version: 1.4.7\n2021-04-05 12:08:38,385 WARN tool.BaseSqoopTool: Setting your password on the command-line is insecure. Consider using -P instead.\n2021-04-05 12:08:38,386 INFO tool.BaseSqoopTool: Using Hive-specific delimiters for output. You can override\n2021-04-05 12:08:38,386 INFO tool.BaseSqoopTool: delimiters with --fields-terminated-by, etc.\n2021-04-05 12:08:38,563 INFO manager.MySQLManager: Preparing to use a MySQL streaming resultset.\n2021-04-05 12:08:38,575 INFO tool.CodeGenTool: Beginning code generation\n2021-04-05 12:08:39,057 INFO manager.SqlManager: Executing SQL statement: SELECT t.* FROM `cities` AS t LIMIT 1\n2021-04-05 12:08:39,096 INFO manager.SqlManager: Executing SQL statement: SELECT t.* FROM `cities` AS t LIMIT 1\n2021-04-05 12:08:39,109 INFO orm.CompilationManager: HADOOP_MAPRED_HOME is /usr/lib/hadoop-mapreduce\nNote: /tmp/sqoop-zeppelin/compile/aa8d6a0f4ab59101ab1b5fbb4b3fc353/cities.java uses or overrides a deprecated API.\nNote: Recompile with -Xlint:deprecation for details.\n2021-04-05 12:08:41,742 INFO orm.CompilationManager: Writing jar file: /tmp/sqoop-zeppelin/compile/aa8d6a0f4ab59101ab1b5fbb4b3fc353/cities.jar\n2021-04-05 12:08:41,763 WARN manager.MySQLManager: It looks like you are importing from mysql.\n2021-04-05 12:08:41,763 WARN manager.MySQLManager: This transfer can be faster! Use the --direct\n2021-04-05 12:08:41,763 WARN manager.MySQLManager: option to exercise a MySQL-specific fast path.\n2021-04-05 12:08:41,763 INFO manager.MySQLManager: Setting zero DATETIME behavior to convertToNull (mysql)\n2021-04-05 12:08:41,770 INFO mapreduce.ImportJobBase: Beginning import of cities\n2021-04-05 12:08:41,772 INFO Configuration.deprecation: mapred.job.tracker is deprecated. Instead, use mapreduce.jobtracker.address\n2021-04-05 12:08:42,055 INFO Configuration.deprecation: mapred.jar is deprecated. Instead, use mapreduce.job.jar\n2021-04-05 12:08:42,718 INFO Configuration.deprecation: mapred.map.tasks is deprecated. Instead, use mapreduce.job.maps\n2021-04-05 12:08:43,058 INFO client.RMProxy: Connecting to ResourceManager at adh-master/10.93.1.9:8032\n2021-04-05 12:08:43,311 INFO client.AHSProxy: Connecting to Application History server at adh-master/10.93.1.9:10200\n2021-04-05 12:08:44,015 INFO mapreduce.JobResourceUploader: Disabling Erasure Coding for path: /user/zeppelin/.staging/job_1589890047834_2197\n2021-04-05 12:08:45,516 INFO db.DBInputFormat: Using read commited transaction isolation\n2021-04-05 12:08:45,581 INFO mapreduce.JobSubmitter: number of splits:1\n2021-04-05 12:08:45,771 INFO mapreduce.JobSubmitter: Submitting tokens for job: job_1589890047834_2197\n2021-04-05 12:08:45,773 INFO mapreduce.JobSubmitter: Executing with tokens: []\n2021-04-05 12:08:46,022 INFO conf.Configuration: resource-types.xml not found\n2021-04-05 12:08:46,023 INFO resource.ResourceUtils: Unable to find 'resource-types.xml'.\n2021-04-05 12:08:46,096 INFO impl.YarnClientImpl: Submitted application application_1589890047834_2197\n2021-04-05 12:08:46,137 INFO mapreduce.Job: The url to track the job: http://adh-master:8088/proxy/application_1589890047834_2197/\n2021-04-05 12:08:46,138 INFO mapreduce.Job: Running job: job_1589890047834_2197\n2021-04-05 12:08:53,260 INFO mapreduce.Job: Job job_1589890047834_2197 running in uber mode : false\n2021-04-05 12:08:53,261 INFO mapreduce.Job:  map 0% reduce 0%\n2021-04-05 12:09:06,387 INFO mapreduce.Job:  map 100% reduce 0%\n2021-04-05 12:09:07,405 INFO mapreduce.Job: Job job_1589890047834_2197 completed successfully\n2021-04-05 12:09:07,526 INFO mapreduce.Job: Counters: 32\n\tFile System Counters\n\t\tFILE: Number of bytes read=0\n\t\tFILE: Number of bytes written=229187\n\t\tFILE: Number of read operations=0\n\t\tFILE: Number of large read operations=0\n\t\tFILE: Number of write operations=0\n\t\tHDFS: Number of bytes read=87\n\t\tHDFS: Number of bytes written=115081794\n\t\tHDFS: Number of read operations=6\n\t\tHDFS: Number of large read operations=0\n\t\tHDFS: Number of write operations=2\n\tJob Counters \n\t\tLaunched map tasks=1\n\t\tOther local map tasks=1\n\t\tTotal time spent by all maps in occupied slots (ms)=11079\n\t\tTotal time spent by all reduces in occupied slots (ms)=0\n\t\tTotal time spent by all map tasks (ms)=11079\n\t\tTotal vcore-milliseconds taken by all map tasks=11079\n\t\tTotal megabyte-milliseconds taken by all map tasks=11344896\n\tMap-Reduce Framework\n\t\tMap input records=3173958\n\t\tMap output records=3173958\n\t\tInput split bytes=87\n\t\tSpilled Records=0\n\t\tFailed Shuffles=0\n\t\tMerged Map outputs=0\n\t\tGC time elapsed (ms)=141\n\t\tCPU time spent (ms)=11450\n\t\tPhysical memory (bytes) snapshot=402493440\n\t\tVirtual memory (bytes) snapshot=2815627264\n\t\tTotal committed heap usage (bytes)=354418688\n\t\tPeak Map Physical memory (bytes)=402493440\n\t\tPeak Map Virtual memory (bytes)=2815627264\n\tFile Input Format Counters \n\t\tBytes Read=0\n\tFile Output Format Counters \n\t\tBytes Written=115081794\n2021-04-05 12:09:07,534 INFO mapreduce.ImportJobBase: Transferred 109.7506 MB in 24.8005 seconds (4.4253 MB/sec)\n2021-04-05 12:09:07,539 INFO mapreduce.ImportJobBase: Retrieved 3173958 records.\n2021-04-05 12:09:07,539 INFO mapreduce.ImportJobBase: Publishing Hive/Hcat import job data to Listeners for table cities\n2021-04-05 12:09:07,580 INFO manager.SqlManager: Executing SQL statement: SELECT t.* FROM `cities` AS t LIMIT 1\n2021-04-05 12:09:07,590 WARN hive.TableDefWriter: Column Population had to be cast to a less precise type in Hive\n2021-04-05 12:09:07,591 WARN hive.TableDefWriter: Column Latitude had to be cast to a less precise type in Hive\n2021-04-05 12:09:07,591 WARN hive.TableDefWriter: Column Longitude had to be cast to a less precise type in Hive\n2021-04-05 12:09:07,597 INFO hive.HiveImport: Loading uploaded data into Hive\n2021-04-05 12:09:07,648 INFO conf.HiveConf: Found configuration file file:/etc/hive/conf/hive-site.xml\n2021-04-05 12:09:12,105 main ERROR Could not register mbeans java.security.AccessControlException: access denied (\"javax.management.MBeanTrustPermission\" \"register\")\n\tat java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)\n\tat java.lang.SecurityManager.checkPermission(SecurityManager.java:585)\n\tat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.checkMBeanTrustPermission(DefaultMBeanServerInterceptor.java:1848)\n\tat com.sun.jmx.interceptor.DefaultMBeanServerInterceptor.registerMBean(DefaultMBeanServerInterceptor.java:322)\n\tat com.sun.jmx.mbeanserver.JmxMBeanServer.registerMBean(JmxMBeanServer.java:522)\n\tat org.apache.logging.log4j.core.jmx.Server.register(Server.java:389)\n\tat org.apache.logging.log4j.core.jmx.Server.reregisterMBeansAfterReconfigure(Server.java:167)\n\tat org.apache.logging.log4j.core.jmx.Server.reregisterMBeansAfterReconfigure(Server.java:140)\n\tat org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:556)\n\tat org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:261)\n\tat org.apache.logging.log4j.core.async.AsyncLoggerContext.start(AsyncLoggerContext.java:87)\n\tat org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:240)\n\tat org.apache.logging.log4j.core.config.Configurator.initialize(Configurator.java:158)\n\tat org.apache.logging.log4j.core.config.Configurator.initialize(Configurator.java:131)\n\tat org.apache.logging.log4j.core.config.Configurator.initialize(Configurator.java:101)\n\tat org.apache.logging.log4j.core.config.Configurator.initialize(Configurator.java:188)\n\tat org.apache.hadoop.hive.common.LogUtils.initHiveLog4jDefault(LogUtils.java:173)\n\tat org.apache.hadoop.hive.common.LogUtils.initHiveLog4jCommon(LogUtils.java:106)\n\tat org.apache.hadoop.hive.common.LogUtils.initHiveLog4jCommon(LogUtils.java:98)\n\tat org.apache.hadoop.hive.common.LogUtils.initHiveLog4j(LogUtils.java:81)\n\tat org.apache.hadoop.hive.cli.CliDriver.run(CliDriver.java:699)\n\tat org.apache.hadoop.hive.cli.CliDriver.main(CliDriver.java:683)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\n\tat sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\n\tat sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\n\tat java.lang.reflect.Method.invoke(Method.java:498)\n\tat org.apache.sqoop.hive.HiveImport.executeScript(HiveImport.java:331)\n\tat org.apache.sqoop.hive.HiveImport.importTable(HiveImport.java:241)\n\tat org.apache.sqoop.tool.ImportTool.importTable(ImportTool.java:537)\n\tat org.apache.sqoop.tool.ImportTool.run(ImportTool.java:628)\n\tat org.apache.sqoop.Sqoop.run(Sqoop.java:147)\n\tat org.apache.hadoop.util.ToolRunner.run(ToolRunner.java:76)\n\tat org.apache.sqoop.Sqoop.runSqoop(Sqoop.java:183)\n\tat org.apache.sqoop.Sqoop.runTool(Sqoop.java:234)\n\tat org.apache.sqoop.Sqoop.runTool(Sqoop.java:243)\n\tat org.apache.sqoop.Sqoop.main(Sqoop.java:252)\n\nHive Session ID = 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:12,216 INFO SessionState: Hive Session ID = 81a1d184-f40b-4922-b616-49df50a6d709\n\nLogging initialized using configuration in jar:file:/usr/lib/hive/lib/hive-common-3.1.1.jar!/hive-log4j2.properties Async: true\n2021-04-05 12:09:12,387 INFO SessionState: \nLogging initialized using configuration in jar:file:/usr/lib/hive/lib/hive-common-3.1.1.jar!/hive-log4j2.properties Async: true\n2021-04-05 12:09:12,463 INFO session.SessionState: Created HDFS directory: /tmp/hive/zeppelin/81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:12,581 INFO session.SessionState: Created local directory: /tmp/zeppelin/81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:12,586 INFO session.SessionState: Created HDFS directory: /tmp/hive/zeppelin/81a1d184-f40b-4922-b616-49df50a6d709/_tmp_space.db\n2021-04-05 12:09:12,613 INFO conf.HiveConf: Using the default value passed in for log id: 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:12,613 INFO session.SessionState: Updating thread name to 81a1d184-f40b-4922-b616-49df50a6d709 main\n2021-04-05 12:09:15,514 INFO metastore.HiveMetaStoreClient: Trying to connect to metastore with URI thrift://adh-master.ru-central1.internal:9083\n2021-04-05 12:09:15,576 INFO metastore.HiveMetaStoreClient: Opened a connection to metastore, current connections: 1\n2021-04-05 12:09:15,626 INFO metastore.HiveMetaStoreClient: Connected to metastore.\n2021-04-05 12:09:15,627 INFO metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=zeppelin (auth:SIMPLE) retries=1 delay=1 lifetime=0\nHive Session ID = 4166dccf-839b-4e01-b879-8c989a4cec4f\n2021-04-05 12:09:16,779 INFO SessionState: Hive Session ID = 4166dccf-839b-4e01-b879-8c989a4cec4f\n2021-04-05 12:09:16,780 INFO conf.HiveConf: Using the default value passed in for log id: 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:16,793 INFO session.SessionState: Created HDFS directory: /tmp/hive/zeppelin/4166dccf-839b-4e01-b879-8c989a4cec4f\n2021-04-05 12:09:16,796 INFO session.SessionState: Created local directory: /tmp/zeppelin/4166dccf-839b-4e01-b879-8c989a4cec4f\n2021-04-05 12:09:16,800 INFO session.SessionState: Created HDFS directory: /tmp/hive/zeppelin/4166dccf-839b-4e01-b879-8c989a4cec4f/_tmp_space.db\n2021-04-05 12:09:17,207 INFO ql.Driver: Compiling command(queryId=zeppelin_20210405120916_45d4e602-575f-4b87-88e9-50de13b76180): CREATE TABLE IF NOT EXISTS `vandriichuk_staging.cities` ( `Country` STRING, `City` STRING, `AccentCity` STRING, `Region` STRING, `Population` DOUBLE, `Latitude` DOUBLE, `Longitude` DOUBLE) COMMENT 'Imported by sqoop on 2021/04/05 12:09:07' ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\001' LINES TERMINATED BY '\\012' STORED AS TEXTFILE\n2021-04-05 12:09:17,573 INFO metadata.HiveMaterializedViewsRegistry: Materialized views registry has been initialized\n2021-04-05 12:09:19,813 INFO ql.Driver: Concurrency mode is disabled, not creating a lock manager\n2021-04-05 12:09:19,829 INFO parse.CalcitePlanner: Starting Semantic Analysis\n2021-04-05 12:09:19,902 INFO sqlstd.SQLStdHiveAccessController: Created SQLStdHiveAccessController for session context : HiveAuthzSessionContext [sessionString=81a1d184-f40b-4922-b616-49df50a6d709, clientType=HIVECLI]\n2021-04-05 12:09:19,919 WARN session.SessionState: METASTORE_FILTER_HOOK will be ignored, since hive.security.authorization.manager is set to instance of HiveAuthorizerFactory.\n2021-04-05 12:09:19,919 INFO metastore.HiveMetaStoreClient: Mestastore configuration metastore.filter.hook changed from org.apache.hadoop.hive.metastore.DefaultMetaStoreFilterHookImpl to org.apache.hadoop.hive.ql.security.authorization.plugin.AuthorizationMetaStoreFilterHook\n2021-04-05 12:09:19,937 INFO metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: 0\n2021-04-05 12:09:19,939 INFO metastore.HiveMetaStoreClient: Trying to connect to metastore with URI thrift://adh-master.ru-central1.internal:9083\n2021-04-05 12:09:19,940 INFO metastore.HiveMetaStoreClient: Opened a connection to metastore, current connections: 1\n2021-04-05 12:09:19,942 INFO metastore.HiveMetaStoreClient: Connected to metastore.\n2021-04-05 12:09:19,942 INFO metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=zeppelin (auth:SIMPLE) retries=1 delay=1 lifetime=0\n2021-04-05 12:09:20,014 INFO parse.CalcitePlanner: Creating table vandriichuk_staging.cities position=27\n2021-04-05 12:09:20,095 INFO metastore.HiveMetaStoreClient: Trying to connect to metastore with URI thrift://adh-master.ru-central1.internal:9083\n2021-04-05 12:09:20,096 INFO metastore.HiveMetaStoreClient: Opened a connection to metastore, current connections: 2\n2021-04-05 12:09:20,098 INFO metastore.HiveMetaStoreClient: Connected to metastore.\n2021-04-05 12:09:20,098 INFO metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=zeppelin (auth:SIMPLE) retries=1 delay=1 lifetime=0\n2021-04-05 12:09:20,244 INFO ql.Driver: Semantic Analysis Completed (retrial = false)\n2021-04-05 12:09:20,258 INFO ql.Driver: Returning Hive schema: Schema(fieldSchemas:null, properties:null)\n2021-04-05 12:09:20,333 INFO ql.Driver: EXPLAIN output for queryid zeppelin_20210405120916_45d4e602-575f-4b87-88e9-50de13b76180 : STAGE DEPENDENCIES:\n\nSTAGE PLANS:\n\n2021-04-05 12:09:20,336 INFO ql.Driver: Completed compiling command(queryId=zeppelin_20210405120916_45d4e602-575f-4b87-88e9-50de13b76180); Time taken: 3.34 seconds\n2021-04-05 12:09:20,337 INFO reexec.ReExecDriver: Execution #1 of query\n2021-04-05 12:09:20,340 INFO ql.Driver: Concurrency mode is disabled, not creating a lock manager\n2021-04-05 12:09:20,340 INFO ql.Driver: Executing command(queryId=zeppelin_20210405120916_45d4e602-575f-4b87-88e9-50de13b76180): CREATE TABLE IF NOT EXISTS `vandriichuk_staging.cities` ( `Country` STRING, `City` STRING, `AccentCity` STRING, `Region` STRING, `Population` DOUBLE, `Latitude` DOUBLE, `Longitude` DOUBLE) COMMENT 'Imported by sqoop on 2021/04/05 12:09:07' ROW FORMAT DELIMITED FIELDS TERMINATED BY '\\001' LINES TERMINATED BY '\\012' STORED AS TEXTFILE\n2021-04-05 12:09:20,364 INFO ql.Driver: Completed executing command(queryId=zeppelin_20210405120916_45d4e602-575f-4b87-88e9-50de13b76180); Time taken: 0.024 seconds\nOK\n2021-04-05 12:09:20,364 INFO ql.Driver: OK\n2021-04-05 12:09:20,364 INFO ql.Driver: Concurrency mode is disabled, not creating a lock manager\nTime taken: 3.376 seconds\n2021-04-05 12:09:20,385 INFO CliDriver: Time taken: 3.376 seconds\n2021-04-05 12:09:20,400 INFO conf.HiveConf: Using the default value passed in for log id: 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:20,400 INFO session.SessionState: Resetting thread name to  main\n2021-04-05 12:09:20,400 INFO conf.HiveConf: Using the default value passed in for log id: 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:20,400 INFO session.SessionState: Updating thread name to 81a1d184-f40b-4922-b616-49df50a6d709 main\n2021-04-05 12:09:20,402 INFO ql.Driver: Compiling command(queryId=zeppelin_20210405120920_60fa09cc-905c-4a66-bacb-1421503c2c4a): \nLOAD DATA INPATH 'hdfs://adh-master:8020/user/zeppelin/cities' INTO TABLE `vandriichuk_staging.cities`\n2021-04-05 12:09:20,424 INFO ql.Driver: Concurrency mode is disabled, not creating a lock manager\n2021-04-05 12:09:20,958 INFO ql.Driver: Semantic Analysis Completed (retrial = false)\n2021-04-05 12:09:20,959 INFO ql.Driver: Returning Hive schema: Schema(fieldSchemas:null, properties:null)\n2021-04-05 12:09:21,011 INFO ql.Driver: EXPLAIN output for queryid zeppelin_20210405120920_60fa09cc-905c-4a66-bacb-1421503c2c4a : STAGE DEPENDENCIES:\n  Stage-0 is a root stage [MOVE]\n  Stage-1 depends on stages: Stage-0 [STATS]\n\nSTAGE PLANS:\n  Stage: Stage-0\n    Move Operator\n      tables:\n          replace: false\n          source: hdfs://adh-master:8020/user/zeppelin/cities\n          table:\n              input format: org.apache.hadoop.mapred.TextInputFormat\n              output format: org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n              properties:\n                bucket_count -1\n                bucketing_version 2\n                column.name.delimiter ,\n                columns country,city,accentcity,region,population,latitude,longitude\n                columns.comments \n                columns.types string:string:string:string:double:double:double\n                comment Imported by sqoop on 2021/04/05 12:07:42\n                field.delim \u0001\n                file.inputformat org.apache.hadoop.mapred.TextInputFormat\n                file.outputformat org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat\n                line.delim \n\n                location hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/cities\n                name vandriichuk_staging.cities\n                numFiles 1\n                numRows 0\n                rawDataSize 0\n                serialization.ddl struct cities { string country, string city, string accentcity, string region, double population, double latitude, double longitude}\n                serialization.format \u0001\n                serialization.lib org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n                totalSize 115081794\n                transient_lastDdlTime 1617624477\n              serde: org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe\n              name: vandriichuk_staging.cities\n\n  Stage: Stage-1\n    Stats Work\n      Basic Stats Work:\n\n\n2021-04-05 12:09:21,011 INFO ql.Driver: Completed compiling command(queryId=zeppelin_20210405120920_60fa09cc-905c-4a66-bacb-1421503c2c4a); Time taken: 0.609 seconds\n2021-04-05 12:09:21,011 INFO reexec.ReExecDriver: Execution #1 of query\n2021-04-05 12:09:21,011 INFO ql.Driver: Concurrency mode is disabled, not creating a lock manager\n2021-04-05 12:09:21,011 INFO ql.Driver: Executing command(queryId=zeppelin_20210405120920_60fa09cc-905c-4a66-bacb-1421503c2c4a): \nLOAD DATA INPATH 'hdfs://adh-master:8020/user/zeppelin/cities' INTO TABLE `vandriichuk_staging.cities`\n2021-04-05 12:09:21,029 INFO ql.Driver: Starting task [Stage-0:MOVE] in serial mode\n2021-04-05 12:09:21,033 INFO metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: 1\nLoading data to table vandriichuk_staging.cities\n2021-04-05 12:09:21,033 INFO exec.Task: Loading data to table vandriichuk_staging.cities from hdfs://adh-master:8020/user/zeppelin/cities\n2021-04-05 12:09:21,035 INFO metastore.HiveMetaStoreClient: Trying to connect to metastore with URI thrift://adh-master.ru-central1.internal:9083\n2021-04-05 12:09:21,036 INFO metastore.HiveMetaStoreClient: Opened a connection to metastore, current connections: 2\n2021-04-05 12:09:21,038 INFO metastore.HiveMetaStoreClient: Connected to metastore.\n2021-04-05 12:09:21,038 INFO metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=zeppelin (auth:SIMPLE) retries=1 delay=1 lifetime=0\n2021-04-05 12:09:21,251 INFO ql.Driver: Starting task [Stage-1:STATS] in serial mode\n2021-04-05 12:09:21,252 INFO metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: 1\n2021-04-05 12:09:21,252 INFO stats.BasicStatsTask: Executing stats task\n2021-04-05 12:09:21,269 INFO metastore.HiveMetaStoreClient: Trying to connect to metastore with URI thrift://adh-master.ru-central1.internal:9083\n2021-04-05 12:09:21,270 INFO metastore.HiveMetaStoreClient: Opened a connection to metastore, current connections: 2\n2021-04-05 12:09:21,272 INFO metastore.HiveMetaStoreClient: Connected to metastore.\n2021-04-05 12:09:21,272 INFO metastore.RetryingMetaStoreClient: RetryingMetaStoreClient proxy=class org.apache.hadoop.hive.ql.metadata.SessionHiveMetaStoreClient ugi=zeppelin (auth:SIMPLE) retries=1 delay=1 lifetime=0\n2021-04-05 12:09:21,469 INFO stats.BasicStatsTask: Table vandriichuk_staging.cities stats: [numFiles=2, numRows=0, totalSize=230163588, rawDataSize=0]\n2021-04-05 12:09:21,470 INFO ql.Driver: Completed executing command(queryId=zeppelin_20210405120920_60fa09cc-905c-4a66-bacb-1421503c2c4a); Time taken: 0.459 seconds\nOK\n2021-04-05 12:09:21,470 INFO ql.Driver: OK\n2021-04-05 12:09:21,470 INFO ql.Driver: Concurrency mode is disabled, not creating a lock manager\nTime taken: 1.068 seconds\n2021-04-05 12:09:21,490 INFO CliDriver: Time taken: 1.068 seconds\n2021-04-05 12:09:21,509 INFO conf.HiveConf: Using the default value passed in for log id: 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:21,509 INFO session.SessionState: Resetting thread name to  main\n2021-04-05 12:09:21,510 INFO conf.HiveConf: Using the default value passed in for log id: 81a1d184-f40b-4922-b616-49df50a6d709\n2021-04-05 12:09:21,522 INFO session.SessionState: Deleted directory: /tmp/hive/zeppelin/81a1d184-f40b-4922-b616-49df50a6d709 on fs with scheme hdfs\n2021-04-05 12:09:21,523 INFO session.SessionState: Deleted directory: /tmp/zeppelin/81a1d184-f40b-4922-b616-49df50a6d709 on fs with scheme file\n2021-04-05 12:09:21,523 INFO metastore.HiveMetaStoreClient: Closed a connection to metastore, current connections: 1\n2021-04-05 12:09:21,523 INFO hive.HiveImport: Hive import complete.\n2021-04-05 12:09:21,526 INFO hive.HiveImport: Export directory is contains the _SUCCESS file only, removing the directory.\nDone\n"}]},"apps":[],"jobName":"paragraph_1617624346454_94409540","id":"20210402-032323_1944232669","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17209","dateFinished":"2021-04-05T12:09:22+0000","dateStarted":"2021-04-05T12:08:33+0000"},{"title":"1.3 Проверяем успешность переноса таблицы","text":"%hive\nselect * from vandriichuk_staging.cities limit 3","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:08:03+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"cities.country":"string","cities.city":"string","cities.accentcity":"string","cities.region":"string","cities.population":"string","cities.latitude":"string","cities.longitude":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"cities.country\tcities.city\tcities.accentcity\tcities.region\tcities.population\tcities.latitude\tcities.longitude\nad\taixas\tAixÃ s\t06\t0.0\t42.0\t1.0\nad\taixirivali\tAixirivali\t06\t0.0\t42.0\t2.0\nad\taixirivall\tAixirivall\t06\t0.0\t42.0\t2.0\n"}]},"apps":[],"jobName":"paragraph_1617624346457_173911462","id":"20210401-085004_705391237","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17210","dateFinished":"2021-04-05T12:08:04+0000","dateStarted":"2021-04-05T12:08:03+0000"},{"title":" ","text":"%mysql\nSELECT * FROM skillfactory.cities LIMIT 3","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":6,"editorMode":"ace/mode/sql","fontSize":9,"title":false,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"Country":"string","City":"string","AccentCity":"string","Region":"string","Population":"string","Latitude":"string","Longitude":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"Country\tCity\tAccentCity\tRegion\tPopulation\tLatitude\tLongitude\nad\taixas\tAixÃ s\t06\t0\t42\t1\nad\taixirivali\tAixirivali\t06\t0\t42\t2\nad\taixirivall\tAixirivall\t06\t0\t42\t2\n"}]},"apps":[],"jobName":"paragraph_1617624346459_1463193298","id":"20210401-114721_520492266","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17211"},{"title":"1.4 Проверяем кол-во строк в новой и исходной таблицах","text":"%hive\nselect count(*) from vandriichuk_staging.cities","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:09:39+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_c0\n6347916\n"}]},"apps":[],"jobName":"paragraph_1617624346461_993240510","id":"20210401-091419_2047739298","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17212","dateFinished":"2021-04-05T12:10:07+0000","dateStarted":"2021-04-05T12:09:39+0000"},{"text":"%mysql\nSELECT COUNT(*) FROM skillfactory.cities","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:09:45+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"COUNT(*)":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"COUNT(*)\n3173958\n"}]},"apps":[],"jobName":"paragraph_1617624346463_-1538436151","id":"20210401-091452_234020130","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17213","dateFinished":"2021-04-05T12:09:46+0000","dateStarted":"2021-04-05T12:09:45+0000"},{"text":"%md\n### 2. Перенос данных из файлов csv в свою базу данных","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>2. Перенос данных из файлов csv в свою базу данных</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346465_-1762161968","id":"20210402-034403_605072449","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17214"},{"title":"2.1 Проверяем наличие исходых файлов csv и их имена","text":"ls /home/deng/Data","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:10:31+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"capital.json\ncontinent.json\ncountries_of_the_world.csv\ncurrency.json\niso3.json\nnames.json\nnobel-laureates.csv\nphone.json\nworldcitiespop.csv\n"}]},"apps":[],"jobName":"paragraph_1617624346467_227385447","id":"20210401-124744_405258843","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17215","dateFinished":"2021-04-05T12:10:31+0000","dateStarted":"2021-04-05T12:10:31+0000"},{"text":"%md\n### 2.2 Перенос данных из файла nobel-laureates.csv","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>2.2 Перенос данных из файла nobel-laureates.csv</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346468_-6778328","id":"20210402-042105_491186644","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17216"},{"title":"2.2.1 nobel-laureates. Создаем новую таблицу (по шаблону из шага 2)","text":"%hive \n\nDROP TABLE IF EXISTS vandriichuk_staging.nobel_laureates_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS vandriichuk_staging.nobel_laureates_ext(\n      year                  INT\n    , category              VARCHAR(255)\n    , prize                 VARCHAR(255)\n    , motivation            VARCHAR(255)\n    , prize_share           VARCHAR(255)\n    , laureate_id           INT\n    , laureate_type         INT\n    , full_name             VARCHAR(255)\n    , bith_date             DATE\n    , birth_city            VARCHAR(255)\n    , birth_country         VARCHAR(255)\n    , sex                   VARCHAR(255)\n    , organization_name     VARCHAR(255)\n    , organization_city     VARCHAR(255)\n    , organization_country  VARCHAR(255)\n    , death_date            DATE\n    , death_city            VARCHAR(255)\n    , death_country         VARCHAR(255)\n)\nCOMMENT 'nobel-laureates.csv'\n\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/sokaa/data/nobel_laureates_ext\"\nTBLPROPERTIES ('skip.header.line.count'='1');","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:10:43+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1617624346470_-101360825","id":"20210401-091548_2075064540","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17217","dateFinished":"2021-04-05T12:10:44+0000","dateStarted":"2021-04-05T12:10:44+0000"},{"title":"2.2.2 nobel-laureates. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"nobel-laureates\"\nexport tabName=\"nobel_laureates\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/home/deng/Data\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:11:17+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nput: `/user/zeppelin/vandriichuk/data/nobel_laureates_ext': No such file or directory: `hdfs://adh-master:8020/user/zeppelin/vandriichuk/data/nobel_laureates_ext'\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.nobel_laureates_orc stored as orc as select * from vandriichuk_staging.nobel_laureates_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.nobel_laureates_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346472_-885540375","id":"20210402-034908_1328128942","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17218","dateFinished":"2021-04-05T12:11:46+0000","dateStarted":"2021-04-05T12:11:18+0000"},{"title":"2.2.3 nobel-laureates. Проверяем успешность переноса данных из файла в таблицу","text":"%hive\nshow tables from vandriichuk_staging","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:12:16+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\ncities\nnobel_laureates_orc\n"}]},"apps":[],"jobName":"paragraph_1617624346474_408045030","id":"20210401-112220_2127164882","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17219","dateFinished":"2021-04-05T12:12:16+0000","dateStarted":"2021-04-05T12:12:16+0000"},{"text":"%hive\nselect * from vandriichuk_staging.nobel_laureates_orc limit 3","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:12:26+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"nobel_laureates_orc.year":"string","nobel_laureates_orc.category":"string","nobel_laureates_orc.prize":"string","nobel_laureates_orc.motivation":"string","nobel_laureates_orc.prize_share":"string","nobel_laureates_orc.laureate_id":"string","nobel_laureates_orc.laureate_type":"string","nobel_laureates_orc.full_name":"string","nobel_laureates_orc.bith_date":"string","nobel_laureates_orc.birth_city":"string","nobel_laureates_orc.birth_country":"string","nobel_laureates_orc.sex":"string","nobel_laureates_orc.organization_name":"string","nobel_laureates_orc.organization_city":"string","nobel_laureates_orc.organization_country":"string","nobel_laureates_orc.death_date":"string","nobel_laureates_orc.death_city":"string","nobel_laureates_orc.death_country":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"nobel_laureates_orc.year\tnobel_laureates_orc.category\tnobel_laureates_orc.prize\tnobel_laureates_orc.motivation\tnobel_laureates_orc.prize_share\tnobel_laureates_orc.laureate_id\tnobel_laureates_orc.laureate_type\tnobel_laureates_orc.full_name\tnobel_laureates_orc.bith_date\tnobel_laureates_orc.birth_city\tnobel_laureates_orc.birth_country\tnobel_laureates_orc.sex\tnobel_laureates_orc.organization_name\tnobel_laureates_orc.organization_city\tnobel_laureates_orc.organization_country\tnobel_laureates_orc.death_date\tnobel_laureates_orc.death_city\tnobel_laureates_orc.death_country\nAfghanistan \tASIA (EX. NEAR EAST)         \t31056997\t647500\t48,0\t0,00\t23,06\t163,07\t700\t36,0\t3,2\t12,13\t0,22\t87,65\t1\t46,6\t20,34\t0,38\nAlbania \tEASTERN EUROPE                     \t3581655\t28748\t124,6\t1,26\t-4,93\t21,52\t4500\t86,5\t71,2\t21,09\t4,42\t74,49\t3\t15,11\t5,22\t0,232\nAlgeria \tNORTHERN AFRICA                    \t32930091\t2381740\t13,8\t0,04\t-0,39\t31\t6000\t70,0\t78,1\t3,22\t0,25\t96,53\t1\t17,14\t4,61\t0,101\n"}]},"apps":[],"jobName":"paragraph_1617624346476_1675942057","id":"20210401-112008_707994292","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17220","dateFinished":"2021-04-05T12:12:26+0000","dateStarted":"2021-04-05T12:12:26+0000"},{"title":"2.2.4 nobel-laureates. Проверяем кол-во строк с данными в новой таблицу и исходном файле","text":"%hive\nselect count(*) from vandriichuk_staging.nobel_laureates_orc","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:12:33+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_c0\n1196\n"}]},"apps":[],"jobName":"paragraph_1617624346478_1948763440","id":"20210401-112101_768166584","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17221","dateFinished":"2021-04-05T12:12:57+0000","dateStarted":"2021-04-05T12:12:33+0000"},{"text":"wc -l /home/deng/Data/nobel-laureates.csv","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:12:49+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"970 /home/deng/Data/nobel-laureates.csv\n"}]},"apps":[],"jobName":"paragraph_1617624346480_684639354","id":"20210401-112827_1875229972","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17222","dateFinished":"2021-04-05T12:12:49+0000","dateStarted":"2021-04-05T12:12:49+0000"},{"text":"%md\n### 2.3 Перенос данных из файла countries_of_the_world.csv","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>2.3 Перенос данных из файла countries_of_the_world.csv</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346482_202912519","id":"20210402-042358_982205403","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17223"},{"title":"2.3.1 countries_of_the_world. Создаем новую таблицу (по шаблону из шага 2)","text":"%hive\nDROP TABLE IF EXISTS vandriichuk_staging.countries_of_the_world_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS vandriichuk_staging.countries_of_the_world_ext(\n      country_name      VARCHAR(255)\n    , region_name       VARCHAR(255)\n    , population        INT\n    , area              INT\n    , pop_density       FLOAT\n    , coast_line        FLOAT\n    , net_migration     FLOAT\n    , infant_mortality  FLOAT\n    , gdp               INT\n    , literacy          FLOAT\n    , phones_per_1000   FLOAT\n    , arable            FLOAT\n    , crops             FLOAT\n    , other             FLOAT\n    , climate           INT\n    , nirthrate         FLOAT\n    , deathrate         FLOAT\n    , agriculture       FLOAT\n    , industry          FLOAT\n    , service           FLOAT\n)\nCOMMENT 'countries_of_the_world.csv'\n\nROW FORMAT SERDE 'org.apache.hadoop.hive.serde2.OpenCSVSerde' STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/sokaa/data/countries_of_the_world_ext\"\nTBLPROPERTIES ('skip.header.line.count'='1');","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:13:11+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1617624346484_-17377566","id":"20210401-113949_1744865895","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17224","dateFinished":"2021-04-05T12:13:11+0000","dateStarted":"2021-04-05T12:13:11+0000"},{"title":"2.3.2 countries_of_the_world. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"countries_of_the_world\"\nexport tabName=\"countries_of_the_world\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/home/deng/Data\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:13:42+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nput: `/user/zeppelin/vandriichuk/data/countries_of_the_world_ext': No such file or directory: `hdfs://adh-master:8020/user/zeppelin/vandriichuk/data/countries_of_the_world_ext'\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.countries_of_the_world_orc stored as orc as select * from vandriichuk_staging.countries_of_the_world_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.countries_of_the_world_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346486_-1077963886","id":"20210402-042710_326568132","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17225","dateFinished":"2021-04-05T12:14:11+0000","dateStarted":"2021-04-05T12:13:42+0000"},{"title":"2.3.3 countries_of_the_world. Проверяем успешность переноса данных из файла в таблицу","text":"%hive\nshow tables from vandriichuk_staging","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:14:17+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\ncities\ncountries_of_the_world_orc\nnobel_laureates_orc\n"}]},"apps":[],"jobName":"paragraph_1617624346488_2026493022","id":"20210402-043338_2073443054","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17226","dateFinished":"2021-04-05T12:14:18+0000","dateStarted":"2021-04-05T12:14:17+0000"},{"text":"%hive\nselect * from vandriichuk_staging.countries_of_the_world_orc limit 3","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:14:26+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"countries_of_the_world_orc.country_name":"string","countries_of_the_world_orc.region_name":"string","countries_of_the_world_orc.population":"string","countries_of_the_world_orc.area":"string","countries_of_the_world_orc.pop_density":"string","countries_of_the_world_orc.coast_line":"string","countries_of_the_world_orc.net_migration":"string","countries_of_the_world_orc.infant_mortality":"string","countries_of_the_world_orc.gdp":"string","countries_of_the_world_orc.literacy":"string","countries_of_the_world_orc.phones_per_1000":"string","countries_of_the_world_orc.arable":"string","countries_of_the_world_orc.crops":"string","countries_of_the_world_orc.other":"string","countries_of_the_world_orc.climate":"string","countries_of_the_world_orc.nirthrate":"string","countries_of_the_world_orc.deathrate":"string","countries_of_the_world_orc.agriculture":"string","countries_of_the_world_orc.industry":"string","countries_of_the_world_orc.service":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"countries_of_the_world_orc.country_name\tcountries_of_the_world_orc.region_name\tcountries_of_the_world_orc.population\tcountries_of_the_world_orc.area\tcountries_of_the_world_orc.pop_density\tcountries_of_the_world_orc.coast_line\tcountries_of_the_world_orc.net_migration\tcountries_of_the_world_orc.infant_mortality\tcountries_of_the_world_orc.gdp\tcountries_of_the_world_orc.literacy\tcountries_of_the_world_orc.phones_per_1000\tcountries_of_the_world_orc.arable\tcountries_of_the_world_orc.crops\tcountries_of_the_world_orc.other\tcountries_of_the_world_orc.climate\tcountries_of_the_world_orc.nirthrate\tcountries_of_the_world_orc.deathrate\tcountries_of_the_world_orc.agriculture\tcountries_of_the_world_orc.industry\tcountries_of_the_world_orc.service\nAfghanistan \tASIA (EX. NEAR EAST)         \t31056997\t647500\t48,0\t0,00\t23,06\t163,07\t700\t36,0\t3,2\t12,13\t0,22\t87,65\t1\t46,6\t20,34\t0,38\t0,24\t0,38\nAlbania \tEASTERN EUROPE                     \t3581655\t28748\t124,6\t1,26\t-4,93\t21,52\t4500\t86,5\t71,2\t21,09\t4,42\t74,49\t3\t15,11\t5,22\t0,232\t0,188\t0,579\nAlgeria \tNORTHERN AFRICA                    \t32930091\t2381740\t13,8\t0,04\t-0,39\t31\t6000\t70,0\t78,1\t3,22\t0,25\t96,53\t1\t17,14\t4,61\t0,101\t0,6\t0,298\n"}]},"apps":[],"jobName":"paragraph_1617624346490_-406975893","id":"20210402-043501_1581624911","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17227","dateFinished":"2021-04-05T12:14:27+0000","dateStarted":"2021-04-05T12:14:26+0000"},{"title":"2.3.4 countries_of_the_world. Проверяем кол-во строк с данными в новой таблицу и исходном файле","text":"%hive\nselect count(*) from vandriichuk_staging.countries_of_the_world_orc","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:14:33+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_c0\n227\n"}]},"apps":[],"jobName":"paragraph_1617624346492_-1990134730","id":"20210402-043559_351281639","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17228","dateFinished":"2021-04-05T12:14:58+0000","dateStarted":"2021-04-05T12:14:33+0000"},{"text":"wc -l /home/deng/Data/countries_of_the_world.csv","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"228 /home/deng/Data/countries_of_the_world.csv\n"}]},"apps":[],"jobName":"paragraph_1617624346493_2010303416","id":"20210401-122256_1591252649","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17229"},{"text":"%md\n### 3. Перенос данных из файлов json в свою базу данных","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>3. Перенос данных из файлов json в свою базу данных</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346496_255793877","id":"20210402-043948_1313970784","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17230"},{"text":"%md\n### 3.1 Конвертация файлов json в файлы csv ","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>3.1 Конвертация файлов json в файлы csv</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346498_-29910071","id":"20210402-044040_36413223","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17231"},{"title":"3.1.1  Создадим папку для хранения файлов csv","text":"mkdir /tmp/vandriichuk","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:14:41+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617624346500_1871450712","id":"20210401-145014_511423666","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17232","dateFinished":"2021-04-05T12:14:41+0000","dateStarted":"2021-04-05T12:14:41+0000"},{"title":"3.1.2 Конвертируем файлы  json в файлы csv ","text":"%python\nimport os\nimport json\nimport pandas as pd\n\nfor dirname, _, filenames in os.walk('/home/deng/Data'):\n    for filename in filenames:\n        if os.path.splitext(filename)[1] == '.json':\n            path = os.path.join(dirname, filename)\n            with open(path, 'r') as file:\n                data = json.load(file)\n            # print(os.path.splitext(filename)[0])\n            df = pd.DataFrame.from_dict(data, orient='index')\n            df.reset_index(inplace=True)\n            df.to_csv('/tmp/vandriichuk/' + os.path.splitext(filename)[0] + '.csv', index=False, header=False)","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:14:52+0000","config":{"editorSetting":{"language":"python","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/python","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[]},"apps":[],"jobName":"paragraph_1617624346502_186379692","id":"20210401-125342_373328333","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17233","dateFinished":"2021-04-05T12:14:52+0000","dateStarted":"2021-04-05T12:14:52+0000"},{"title":"3.1.3 Проверяем успех конвертации","text":"\nls /tmp/vandriichuk","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:14:57+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"capital.csv\ncontinent.csv\ncurrency.csv\niso3.csv\nnames.csv\nphone.csv\n"}]},"apps":[],"jobName":"paragraph_1617624346503_463121516","id":"20210401-150927_1079412588","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17234","dateFinished":"2021-04-05T12:14:57+0000","dateStarted":"2021-04-05T12:14:57+0000"},{"text":"%md\n### 3.2 Перенос данных из файла capital.csv","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>3.2 Перенос данных из файла capital.csv</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346505_1407487952","id":"20210402-044656_1467117378","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17235"},{"title":"3.2.1 capital. Создаем новую таблицу (по шаблону из шага 2)","text":"%hive\nDROP TABLE IF EXISTS vandriichuk_staging.capital_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS  vandriichuk_staging.capital_ext(\n      country_ID      VARCHAR(255)\n    , capital         VARCHAR(255)\n)\nCOMMENT 'capital.json'\n\nROW FORMAT delimited fields terminated by ',' lines terminated by \"\\n\" STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/vandriichuk/data/capital_ext\";","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:15:13+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1617624346507_1275379958","id":"20210401-132731_535807519","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17236","dateFinished":"2021-04-05T12:15:14+0000","dateStarted":"2021-04-05T12:15:13+0000"},{"title":"3.2.2 capital. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"capital\"\nexport tabName=\"capital\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/tmp/vandriichuk\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:15:55+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"editorHide":false,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.capital_orc stored as orc as select * from vandriichuk_staging.capital_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.capital_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346509_673107327","id":"20210402-045129_1359549184","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17237","dateFinished":"2021-04-05T12:16:23+0000","dateStarted":"2021-04-05T12:15:55+0000"},{"title":"3.2.3 capital. Проверяем успешность переноса данных из файла в таблицу","text":"%hive\nshow tables from vandriichuk_staging","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:17:28+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"editorHide":false,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\ncapital_orc\ncities\ncountries_of_the_world_orc\nnobel_laureates_orc\n"}]},"apps":[],"jobName":"paragraph_1617624346511_-1136193900","id":"20210402-045637_2057142392","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17238","dateFinished":"2021-04-05T12:17:29+0000","dateStarted":"2021-04-05T12:17:28+0000"},{"text":"%hive\nselect * from vandriichuk_staging.capital_orc limit 3","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:17:36+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"capital_orc.country_id":"string","capital_orc.capital":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"capital_orc.country_id\tcapital_orc.capital\nBD\tDhaka\nBE\tBrussels\nBF\tOuagadougou\n"}]},"apps":[],"jobName":"paragraph_1617624346513_1930860840","id":"20210401-151211_471161371","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17239","dateFinished":"2021-04-05T12:17:37+0000","dateStarted":"2021-04-05T12:17:36+0000"},{"title":"3.2.4 capital. Проверяем кол-во строк с данными в новой таблицу и исходном файле","text":"%hive\nselect count(*) from vandriichuk_staging.capital_orc","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:17:43+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"_c0":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"_c0\n250\n"}]},"apps":[],"jobName":"paragraph_1617624346515_-300184713","id":"20210401-131048_1925005751","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17240","dateFinished":"2021-04-05T12:18:04+0000","dateStarted":"2021-04-05T12:17:43+0000"},{"text":"%md\nНа шаге 2 на этапе предварительного анализа мы видели что все файлы json содержат по 250 строк данных","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<p>На шаге 2 на этапе предварительного анализа мы видели что все файлы json содержат по 250 строк данных</p>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346517_-797905131","id":"20210402-052019_1560375867","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17241"},{"text":"%md\n### 3.3 Перенос данных из оставшихся файлов csv","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>3.3 Перенос данных из оставшихся файлов csv</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346519_-36284369","id":"20210402-052459_1569571741","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17242"},{"title":"3.3.1 Создаем новые таблицы (по шаблону из шага 2)","text":"%hive\nDROP TABLE IF EXISTS vandriichuk_staging.continent_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS  vandriichuk_staging.continent_ext(\n      country_ID        VARCHAR(255)\n    , continent         VARCHAR(255)\n)\nCOMMENT 'continent.json'\nROW FORMAT delimited fields terminated by ',' lines terminated by \"\\n\" STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/vandriichuk/data/continent_ext\";\n\n\nDROP TABLE IF EXISTS vandriichuk_staging.currency_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS vandriichuk_staging.currency_ext(\n      country_ID        VARCHAR(255)\n    , currency          VARCHAR(255)\n)\nCOMMENT 'currency.json'\nROW FORMAT delimited fields terminated by ',' lines terminated by \"\\n\" STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/vandriichuk/data/currency_ext\";\n\n\nDROP TABLE IF EXISTS vandriichuk_staging.iso3_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS vandriichuk_staging.iso3_ext(\n      country_ID        VARCHAR(255)\n    , iso3_code         VARCHAR(255)\n)\nCOMMENT 'iso3.json'\nROW FORMAT delimited fields terminated by ',' lines terminated by \"\\n\" STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/vandriichuk/data/iso3_ext\";\n\n\nDROP TABLE IF EXISTS vandriichuk_staging.country_names_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS vandriichuk_staging.country_names_ext(\n      country_ID       VARCHAR(255)\n    , country_name     VARCHAR(255)\n)\nCOMMENT 'names.json'\nROW FORMAT delimited fields terminated by ',' lines terminated by \"\\n\" STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/vandriichuk/data/country_names_ext\";\n\n\nDROP TABLE IF EXISTS vandriichuk_staging.phone_ext;\nCREATE EXTERNAL TABLE IF NOT EXISTS vandriichuk_staging.phone_ext(\n      country_ID       VARCHAR(255)\n    , phone            VARCHAR(255)\n)\nCOMMENT 'phone.json'\nROW FORMAT delimited fields terminated by ',' lines terminated by \"\\n\" STORED AS TEXTFILE\nLOCATION \"/user/zeppelin/vandriichuk/data/phone_ext\";","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:18:37+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"},{"type":"TEXT","data":"Query executed successfully. Affected rows : -1"}]},"apps":[],"jobName":"paragraph_1617624346521_901617154","id":"20210401-151746_1715812318","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17243","dateFinished":"2021-04-05T12:18:38+0000","dateStarted":"2021-04-05T12:18:37+0000"},{"title":"3.3.2 continent. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"continent\"\nexport tabName=\"continent\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/tmp/sokaa\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:18:53+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.continent_orc stored as orc as select * from vandriichuk_staging.continent_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.continent_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346523_234537364","id":"20210402-055713_529544152","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17244","dateFinished":"2021-04-05T12:19:19+0000","dateStarted":"2021-04-05T12:18:53+0000"},{"title":"3.3.3 currency. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"currency\"\nexport tabName=\"currency\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/tmp/vandriichuk\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:19:23+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.currency_orc stored as orc as select * from vandriichuk_staging.currency_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.currency_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346525_-1688932780","id":"20210402-060023_1626664533","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17245","dateFinished":"2021-04-05T12:19:51+0000","dateStarted":"2021-04-05T12:19:23+0000"},{"title":"3.3.4 iso3. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"iso3\"\nexport tabName=\"iso3\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/tmp/vandriichuk\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:19:58+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.iso3_orc stored as orc as select * from vandriichuk_staging.iso3_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.iso3_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346527_-846970369","id":"20210402-060104_631708745","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17246","dateFinished":"2021-04-05T12:20:25+0000","dateStarted":"2021-04-05T12:19:58+0000"},{"title":"3.3.5 phone. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"phone\"\nexport tabName=\"phone\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/tmp/vandriichuk\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:20:28+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.phone_orc stored as orc as select * from vandriichuk_staging.phone_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.phone_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346529_-787727657","id":"20210402-060100_2124930966","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17247","dateFinished":"2021-04-05T12:20:55+0000","dateStarted":"2021-04-05T12:20:28+0000"},{"title":"3.3.6 names. Делаем копирование файла csv, создаем таблицу _orc и удаляем таблицу _ext","text":"export fileName=\"names\"\nexport tabName=\"country_names\"\nexport dbName=\"vandriichuk_staging\"\nexport pathToFile=\"/tmp/vandriichuk\"\n\nexport hiveTab_orc=\"$dbName.$tabName\"\"_orc\"\nexport hiveTab_ext=\"$dbName.$tabName\"\"_ext\"\n\nexport path1=\"$pathToFile\"\"/\"\"$fileName\"\".csv\"\nexport path2=\"/user/zeppelin/vandriichuk/data/\"\"$tabName\"\"_ext\"\n\nhdfs dfs -put -f $path1 $path2\n\n./vandriichuk/execHiveCmd.sh \"create table $hiveTab_orc stored as orc as select * from $hiveTab_ext\"\n./vandriichuk/execHiveCmd.sh \"drop table $hiveTab_ext\"","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:21:04+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"title":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (create table vandriichuk_staging.country_names_orc stored as orc as select * from vandriichuk_staging.country_names_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\nСтарт выполнения скрипта ./vandriichuk/execHiveCmd.sh\n-------------------------------------------\n1. Hive QL команда: (drop table vandriichuk_staging.country_names_ext) .............Выполнена успешно.\n   При желании можно проверить лог-файл вывода выполнения команды в файле vandriichuk_execHiveCmd_stdout.txt\n\n2. Удаление временного файла ./vandriichuk/sql.txt .............Выполнено.\n\n3. Скрипт execHiveCmd.sh завершён.\n"}]},"apps":[],"jobName":"paragraph_1617624346531_1351418981","id":"20210402-060238_584909101","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17248","dateFinished":"2021-04-05T12:21:34+0000","dateStarted":"2021-04-05T12:21:05+0000"},{"title":"3.3.7 capital. Проверяем успешность переноса данных из файла в таблицу","text":"%hive\nshow tables from vandriichuk_staging","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:21:13+0000","config":{"editorSetting":{"language":"sql","editOnDblClick":false,"completionSupport":true},"colWidth":12,"editorMode":"ace/mode/sql","fontSize":9,"title":true,"results":{"0":{"graph":{"mode":"table","height":300,"optionOpen":false,"setting":{"table":{"tableGridState":{},"tableColumnTypeState":{"names":{"tab_name":"string"},"updated":false},"tableOptionSpecHash":"[{\"name\":\"useFilter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable filter for columns\"},{\"name\":\"showPagination\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable pagination for better navigation\"},{\"name\":\"showAggregationFooter\",\"valueType\":\"boolean\",\"defaultValue\":false,\"widget\":\"checkbox\",\"description\":\"Enable a footer for displaying aggregated values\"}]","tableOptionValue":{"useFilter":false,"showPagination":false,"showAggregationFooter":false},"updated":false,"initialized":false}},"commonSetting":{}}}},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"tab_name\ncapital_orc\ncities\ncontinent_orc\ncountries_of_the_world_orc\ncountry_names_ext\ncurrency_orc\niso3_orc\nnobel_laureates_orc\nphone_orc\n"}]},"apps":[],"jobName":"paragraph_1617624346533_-966894831","id":"20210401-162333_418987570","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17249","dateFinished":"2021-04-05T12:21:13+0000","dateStarted":"2021-04-05T12:21:13+0000"},{"text":"%md\n### 4. Сохранение описания таблиц (describe extended)  в файл","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"tableHide":false,"editorSetting":{"language":"markdown","editOnDblClick":true,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/markdown","fontSize":9,"editorHide":true,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"HTML","data":"<div class=\"markdown-body\">\n<h3>4. Сохранение описания таблиц (describe extended) в файл</h3>\n</div>"}]},"apps":[],"jobName":"paragraph_1617624346535_-965738795","id":"20210402-061202_1288344948","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17250"},{"text":"hive -e    \"describe extended vandriichuk_staging.cities;\\\n            describe extended vandriichuk_staging.capital_orc;\\\n            describe extended vandriichuk_staging.continent_orc;\\\n            describe extended vandriichuk_staging.countries_of_the_world_orc;\\\n            describe extended vandriichuk_staging.currency_orc;\\\n            describe extended vandriichuk_staging.iso3_orc;\\\n            describe extended vandriichuk_staging.country_names_orc;\\\n            describe extended vandriichuk_staging.nobel_laureates_orc;\\\n            describe extended vandriichuk_staging.phone_orc;\"\\\n    >/tmp/vandriichuk/vandriichuk_output.txt","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:21:45+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"WARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nWARNING: HADOOP_PREFIX has been replaced by HADOOP_HOME. Using value of HADOOP_PREFIX.\nSLF4J: Class path contains multiple SLF4J bindings.\nSLF4J: Found binding in [jar:file:/usr/lib/hive/lib/log4j-slf4j-impl-2.10.0.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: Found binding in [jar:file:/usr/lib/hadoop/lib/slf4j-log4j12-1.7.25.jar!/org/slf4j/impl/StaticLoggerBinder.class]\nSLF4J: See http://www.slf4j.org/codes.html#multiple_bindings for an explanation.\nSLF4J: Actual binding is of type [org.apache.logging.slf4j.Log4jLoggerFactory]\nHive Session ID = 2478f24d-3b78-4eea-82c2-d2753710c7b1\n\nLogging initialized using configuration in jar:file:/usr/lib/hive/lib/hive-common-3.1.1.jar!/hive-log4j2.properties Async: true\nHive Session ID = aced9a89-5ef4-406f-b3c9-61000eccee4b\nOK\nTime taken: 1.344 seconds, Fetched: 9 row(s)\nOK\nTime taken: 0.074 seconds, Fetched: 4 row(s)\nOK\nTime taken: 0.064 seconds, Fetched: 4 row(s)\nOK\nTime taken: 0.06 seconds, Fetched: 22 row(s)\nOK\nTime taken: 0.062 seconds, Fetched: 4 row(s)\nOK\nTime taken: 0.063 seconds, Fetched: 4 row(s)\nOK\nTime taken: 0.062 seconds, Fetched: 4 row(s)\nOK\nTime taken: 0.062 seconds, Fetched: 20 row(s)\nOK\nTime taken: 0.059 seconds, Fetched: 4 row(s)\n"}]},"apps":[],"jobName":"paragraph_1617624346537_1177476414","id":"20210401-162611_1325010423","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17251","dateFinished":"2021-04-05T12:21:57+0000","dateStarted":"2021-04-05T12:21:45+0000"},{"text":"more /tmp/vandriichuk/vandriichuk_output.txt","user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:22:10+0000","config":{"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"colWidth":12,"editorMode":"ace/mode/sh","fontSize":9,"results":{},"enabled":true},"settings":{"params":{},"forms":{}},"results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"::::::::::::::\n/tmp/vandriichuk/vandriichuk_output.txt\n::::::::::::::\ncountry             \tstring              \t                    \ncity                \tstring              \t                    \naccentcity          \tstring              \t                    \nregion              \tstring              \t                    \npopulation          \tdouble              \t                    \nlatitude            \tdouble              \t                    \nlongitude           \tdouble              \t                    \n\t \t \nDetailed Table Information\tTable(tableName:cities, dbName:vandriichuk_staging, owner:zeppelin, createTime:1617624476, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country, type:string, comment:null), FieldSchema(name:city, type:string, comment:null), FieldSchema(name:accentcity, type:string, comment:null), FieldSchema(name:region, type:string, comment:null), FieldSchema(name:population, type:double, comment:null), FieldSchema(name:latitude, type:double, comment:null), FieldSchema(name:longitude, type:double, comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/cities, inputFormat:org.apache.hadoop.mapred.TextInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.HiveIgnoreKeyTextOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.serde2.lazy.LazySimpleSerDe, parameters:{serialization.format=\u0001, line.delim=\\n, field.delim=\u0001}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=230163588, numRows=0, rawDataSize=0, numFiles=2, transient_lastDdlTime=1617624561, bucketing_version=2, comment=Imported by sqoop on 2021/04/05 12:07:42}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_id          \tvarchar(255)        \t                    \ncapital             \tvarchar(255)        \t                    \n\t \t \nDetailed Table Information\tTable(tableName:capital_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617624978, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_id, type:varchar(255), comment:null), FieldSchema(name:capital, type:varchar(255), comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/capital_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=2046, numRows=250, rawDataSize=44250, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617624978, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_id          \tvarchar(255)        \t                    \ncontinent           \tvarchar(255)        \t                    \n\t \t \nDetailed Table Information\tTable(tableName:continent_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617625155, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_id, type:varchar(255), comment:null), FieldSchema(name:continent, type:varchar(255), comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/continent_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=790, numRows=250, rawDataSize=43000, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617625155, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_name        \tstring              \t                    \nregion_name         \tstring              \t                    \npopulation          \tstring              \t                    \narea                \tstring              \t                    \npop_density         \tstring              \t                    \ncoast_line          \tstring              \t                    \nnet_migration       \tstring              \t                    \ninfant_mortality    \tstring              \t                    \ngdp                 \tstring              \t                    \nliteracy            \tstring              \t                    \nphones_per_1000     \tstring              \t                    \narable              \tstring              \t                    \ncrops               \tstring              \t                    \nother               \tstring              \t                    \nclimate             \tstring              \t                    \nnirthrate           \tstring              \t                    \ndeathrate           \tstring              \t                    \nagriculture         \tstring              \t                    \nindustry            \tstring              \t                    \nservice             \tstring              \t                    \n\t \t \nDetailed Table Information\tTable(tableName:countries_of_the_world_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617624846, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_name, type:string, comment:null), FieldSchema(name:region_name, type:string, comment:null), FieldSchema(name:population, type:string, comment:null), FieldSchema(name:area, type:string, comment:null), FieldSchema(name:pop_density, type:string, comment:null), FieldSchema(name:coast_line, type:string, comment:null), FieldSchema(name:net_migration, type:string, comment:null), FieldSchema(name:infant_mortality, type:string, comment:null), FieldSchema(name:gdp, type:string, comment:null), FieldSchema(name:literacy, type:string, comment:null), FieldSchema(name:phones_per_1000, type:string, comment:null), FieldSchema(name:arable, type:string, comment:null), FieldSchema(name:crops, type:string, comment:null), FieldSchema(name:other, type:string, comment:null), FieldSchema(name:climate, type:string, comment:null), FieldSchema(name:nirthrate, type:string, comment:null), FieldSchema(name:deathrate, type:string, comment:null), FieldSchema(name:agriculture, type:string, comment:null), FieldSchema(name:industry, type:string, comment:null), FieldSchema(name:service, type:string, comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/countries_of_the_world_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=14448, numRows=227, rawDataSize=406103, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617624846, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_id          \tvarchar(255)        \t                    \ncurrency            \tvarchar(255)        \t                    \n\t \t \nDetailed Table Information\tTable(tableName:currency_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617625186, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_id, type:varchar(255), comment:null), FieldSchema(name:currency, type:varchar(255), comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/currency_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=1216, numRows=250, rawDataSize=43000, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617625187, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_id          \tvarchar(255)        \t                    \niso3_code           \tvarchar(255)        \t                    \n\t \t \nDetailed Table Information\tTable(tableName:iso3_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617625221, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_id, type:varchar(255), comment:null), FieldSchema(name:iso3_code, type:varchar(255), comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/iso3_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=1129, numRows=250, rawDataSize=43250, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617625221, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_id          \tvarchar(255)        \t                    \ncountry_name        \tvarchar(255)        \t                    \n\t \t \nDetailed Table Information\tTable(tableName:country_names_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617625289, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_id, type:varchar(255), comment:null), FieldSchema(name:country_name, type:varchar(255), comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/country_names_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=2265, numRows=250, rawDataSize=44750, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617625289, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\nyear                \tstring              \t                    \ncategory            \tstring              \t                    \nprize               \tstring              \t                    \nmotivation          \tstring              \t                    \nprize_share         \tstring              \t                    \nlaureate_id         \tstring              \t                    \nlaureate_type       \tstring              \t                    \nfull_name           \tstring              \t                    \nbith_date           \tstring              \t                    \nbirth_city          \tstring              \t                    \nbirth_country       \tstring              \t                    \nsex                 \tstring              \t                    \norganization_name   \tstring              \t                    \norganization_city   \tstring              \t                    \norganization_country\tstring              \t                    \ndeath_date          \tstring              \t                    \ndeath_city          \tstring              \t                    \ndeath_country       \tstring              \t                    \n\t \t \nDetailed Table Information\tTable(tableName:nobel_laureates_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617624701, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:year, type:string, comment:null), FieldSchema(name:category, type:string, comment:null), FieldSchema(name:prize, type:string, comment:null), FieldSchema(name:motivation, type:string, comment:null), FieldSchema(name:prize_share, type:string, comment:null), FieldSchema(name:laureate_id, type:string, comment:null), FieldSchema(name:laureate_type, type:string, comment:null), FieldSchema(name:full_name, type:string, comment:null), FieldSchema(name:bith_date, type:string, comment:null), FieldSchema(name:birth_city, type:string, comment:null), FieldSchema(name:birth_country, type:string, comment:null), FieldSchema(name:sex, type:string, comment:null), FieldSchema(name:organization_name, type:string, comment:null), FieldSchema(name:organization_city, type:string, comment:null), FieldSchema(name:organization_country, type:string, comment:null), FieldSchema(name:death_date, type:string, comment:null), FieldSchema(name:death_city, type:string, comment:null), FieldSchema(name:death_country, type:string, comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/nobel_laureates_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=83226, numRows=1196, rawDataSize=2089412, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617624702, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\ncountry_id          \tvarchar(255)        \t                    \nphone               \tvarchar(255)        \t                    \n\t \t \nDetailed Table Information\tTable(tableName:phone_orc, dbName:vandriichuk_staging, owner:hive, createTime:1617625250, lastAccessTime:0, retention:0, sd:StorageDescriptor(cols:[FieldSchema(name:country_id, type:varchar(255), comment:null), FieldSchema(name:phone, type:varchar(255), comment:null)], location:hdfs://adh-master:8020/apps/hive/warehouse/vandriichuk_staging.db/phone_orc, inputFormat:org.apache.hadoop.hive.ql.io.orc.OrcInputFormat, outputFormat:org.apache.hadoop.hive.ql.io.orc.OrcOutputFormat, compressed:false, numBuckets:-1, serdeInfo:SerDeInfo(name:null, serializationLib:org.apache.hadoop.hive.ql.io.orc.OrcSerde, parameters:{serialization.format=1}), bucketCols:[], sortCols:[], parameters:{}, skewedInfo:SkewedInfo(skewedColNames:[], skewedColValues:[], skewedColValueLocationMaps:{}), storedAsSubDirectories:false), partitionKeys:[], parameters:{totalSize=1197, numRows=250, rawDataSize=43250, COLUMN_STATS_ACCURATE={\\\"BASIC_STATS\\\":\\\"true\\\"}, numFiles=1, transient_lastDdlTime=1617625250, bucketing_version=2}, viewOriginalText:null, viewExpandedText:null, tableType:MANAGED_TABLE, rewriteEnabled:false, catName:hive, ownerType:USER)\t\n"}]},"apps":[],"jobName":"paragraph_1617624346539_380487323","id":"20210401-162929_841206932","dateCreated":"2021-04-05T12:05:46+0000","status":"FINISHED","progressUpdateIntervalMs":500,"$$hashKey":"object:17252","dateFinished":"2021-04-05T12:22:10+0000","dateStarted":"2021-04-05T12:22:10+0000"},{"user":"v.andriichuk@gmail.com","dateUpdated":"2021-04-05T12:05:46+0000","config":{"colWidth":12,"fontSize":9,"enabled":true,"results":{},"editorSetting":{"language":"sh","editOnDblClick":false,"completionSupport":false},"editorMode":"ace/mode/sh"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1617624346543_1217751464","id":"20210402-040904_472935816","dateCreated":"2021-04-05T12:05:46+0000","status":"READY","errorMessage":"","progressUpdateIntervalMs":500,"$$hashKey":"object:17253"}],"name":"vandriichuk/3_9_Шаг_3 1","id":"2G4462FDC","noteParams":{},"noteForms":{},"angularObjects":{"md:shared_process":[],"python:shared_process":[],"mysql:shared_process":[],"sh:shared_process":[],"hive:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}